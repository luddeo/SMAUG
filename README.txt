Fork with some smaller changes
